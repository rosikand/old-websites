<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>PyTorch Reference Document </title><style>
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, YuMincho, "Yu Mincho", "Hiragino Mincho ProN", "Hiragino Mincho Pro", "Songti TC", "Songti SC", "SimSun", "Nanum Myeongjo", NanumMyeongjo, Batang, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC', 'Noto Sans CJK KR'; }

.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC', 'Noto Sans Mono CJK KR'; }

.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, YuMincho, "Yu Mincho", "Hiragino Mincho ProN", "Hiragino Mincho Pro", "Songti TC", "Songti SC", "SimSun", "Nanum Myeongjo", NanumMyeongjo, Batang, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC', 'Noto Sans CJK KR'; }

.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC', 'Noto Sans Mono CJK KR'; }

.highlight-default {
}
.highlight-gray {
	color: rgb(155,154,151);
}
.highlight-brown {
	color: rgb(100,71,58);
}
.highlight-orange {
	color: rgb(217,115,13);
}
.highlight-yellow {
	color: rgb(223,171,1);
}
.highlight-teal {
	color: rgb(15,123,108);
}
.highlight-blue {
	color: rgb(11,110,153);
}
.highlight-purple {
	color: rgb(105,64,165);
}
.highlight-pink {
	color: rgb(173,26,114);
}
.highlight-red {
	color: rgb(224,62,62);
}
.highlight-gray_background {
	background: rgb(235,236,237);
}
.highlight-brown_background {
	background: rgb(233,229,227);
}
.highlight-orange_background {
	background: rgb(250,235,221);
}
.highlight-yellow_background {
	background: rgb(251,243,219);
}
.highlight-teal_background {
	background: rgb(221,237,234);
}
.highlight-blue_background {
	background: rgb(221,235,241);
}
.highlight-purple_background {
	background: rgb(234,228,242);
}
.highlight-pink_background {
	background: rgb(244,223,235);
}
.highlight-red_background {
	background: rgb(251,228,228);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(55, 53, 47, 0.6);
	fill: rgba(55, 53, 47, 0.6);
}
.block-color-brown {
	color: rgb(100,71,58);
	fill: rgb(100,71,58);
}
.block-color-orange {
	color: rgb(217,115,13);
	fill: rgb(217,115,13);
}
.block-color-yellow {
	color: rgb(223,171,1);
	fill: rgb(223,171,1);
}
.block-color-teal {
	color: rgb(15,123,108);
	fill: rgb(15,123,108);
}
.block-color-blue {
	color: rgb(11,110,153);
	fill: rgb(11,110,153);
}
.block-color-purple {
	color: rgb(105,64,165);
	fill: rgb(105,64,165);
}
.block-color-pink {
	color: rgb(173,26,114);
	fill: rgb(173,26,114);
}
.block-color-red {
	color: rgb(224,62,62);
	fill: rgb(224,62,62);
}
.block-color-gray_background {
	background: rgb(235,236,237);
}
.block-color-brown_background {
	background: rgb(233,229,227);
}
.block-color-orange_background {
	background: rgb(250,235,221);
}
.block-color-yellow_background {
	background: rgb(251,243,219);
}
.block-color-teal_background {
	background: rgb(221,237,234);
}
.block-color-blue_background {
	background: rgb(221,235,241);
}
.block-color-purple_background {
	background: rgb(234,228,242);
}
.block-color-pink_background {
	background: rgb(244,223,235);
}
.block-color-red_background {
	background: rgb(251,228,228);
}
.select-value-color-default { background-color: rgba(206,205,202,0.5); }
.select-value-color-gray { background-color: rgba(155,154,151, 0.4); }
.select-value-color-brown { background-color: rgba(140,46,0,0.2); }
.select-value-color-orange { background-color: rgba(245,93,0,0.2); }
.select-value-color-yellow { background-color: rgba(233,168,0,0.2); }
.select-value-color-green { background-color: rgba(0,135,107,0.2); }
.select-value-color-blue { background-color: rgba(0,120,223,0.2); }
.select-value-color-purple { background-color: rgba(103,36,222,0.2); }
.select-value-color-pink { background-color: rgba(221,0,129,0.2); }
.select-value-color-red { background-color: rgba(255,0,26,0.2); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="192df991-5733-4a9b-b674-5f9da53fda9d" class="page sans"><header><div class="page-header-icon undefined"><span class="icon">🔥</span></div><h1 class="page-title">PyTorch Reference Document </h1></header><div class="page-body"><p id="f2355797-e1d0-4a60-85d5-c062df024c68" class=""><strong>By: Rohan Sikand</strong></p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="0a8684a7-ca5b-4115-ae1a-764c4d053e18"><div style="font-size:1.5em"><span class="icon">📌</span></div><div style="width:100%">This is a &quot;cheatsheet&quot; style guide/reference to the PyTorch deep learning framework. </div></figure><p id="991fc149-8447-42a3-a550-e6ef73ad14bc" class=""><strong>Table of Contents: </strong></p><nav id="ab99f61f-d2a0-48bf-b095-6af67e904314" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#432ea7a9-0028-4b9c-811c-1f85dfbe06c3">Part 1: Tensors</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#891d70d9-7a11-4cbc-8852-b1c4a67e6fe2">Tensors </a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#f64c18a0-18dd-42e3-a0e6-a3cb321329a8">Tensor Operations </a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#507f823b-dda8-459d-8145-86541edf538c">Part 2: Neural Networks and Deep Learning </a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#5753976b-6e39-45f2-b3da-f69476c949f4">Data and Data Preprocessing</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#a6c93388-cc4d-4679-95f1-c8d29cb7799c">Constructing Neural Networks</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#1aee063e-d1a8-490f-ba01-e7a87b9cf882">Convolutional Neural Networks </a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#b538f011-47e0-49b0-9d3b-7ba9ed7d53dc">References</a></div></nav><hr id="1ad2a424-edd7-40eb-b767-7be414e7abd3"/><h1 id="432ea7a9-0028-4b9c-811c-1f85dfbe06c3" class="">Part 1: Tensors</h1><h2 id="891d70d9-7a11-4cbc-8852-b1c4a67e6fe2" class="">Tensors </h2><ul id="6724bf78-435f-4ccc-9ca7-d487e2998638" class="toggle"><li><details open=""><summary><strong>Creating tensors from data </strong></summary><h3 id="262181a5-ef75-4187-99d9-0a0875d555da" class="">From data </h3><p id="df257fac-57d2-47f2-83bb-1c584c4c3ce8" class="">For the following, we will use this Numpy array: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="aa72df0e-55ac-41b9-a858-730c77142cfd" class="code code-wrap"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
data <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># data must be a list (convert to it if not) </span></code></pre><p id="e3e7ee1d-5fde-4b94-8b74-0d96724b3efa" class="">Four different methods: </p><p id="87121b27-fb6b-4156-b51d-3fce8c9b5723" class="">The first two creation methods <strong>make a new copy of data</strong> in memory. Thus, changes to <code>data</code> will not persist. </p><ol id="0e1518c3-367e-494c-be7c-af70f3f0b8a1" class="numbered-list" start="1"><li><strong>Use tensor class constructor </strong></li></ol><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="e52cfa34-2697-40cc-9b7d-40b5bbcb7aec" class="code code-wrap"><code><span class="token comment"># floats are output no matter what </span>
torch<span class="token punctuation">.</span>Tensor<span class="token punctuation">(</span>data<span class="token punctuation">)</span></code></pre><hr id="b7db9e99-2aa1-4a8a-b522-4e3de80407e9"/><p id="872cb5a8-d7f8-45da-8035-b0b9e5127bde" class="">The following methods are <strong>factory functions </strong>and keep the original data type for the elements. </p><p id="b072dd7e-012d-4b1d-997e-326b0ab331e2" class=""><strong>2. Helper function of tensor class (</strong><mark class="highlight-red"><strong>recommended</strong></mark><strong>) </strong></p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="f5ef5591-a39d-4986-92bb-5c8e173165a3" class="code code-wrap"><code>torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>data<span class="token punctuation">)</span></code></pre><p id="a89121fa-9f88-4bbe-b8b1-3a5feabe0d7a" class="">The following two creation methods <strong>share memory</strong> with the variable <code>data</code> (for efficiency). Thus, changes to <code>data</code> will persist in the use of these tensors. </p><p id="aadf4e6f-412e-4733-8f63-234237da7947" class=""><strong>3. Conversion </strong></p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="8ad2d583-0bd5-4eae-91d8-96213ae366cb" class="code code-wrap"><code>torch<span class="token punctuation">.</span>as_tensor<span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token comment"># good for tuning purposes </span></code></pre><p id="c22c892f-38d2-4358-b2f5-907643844702" class=""><strong>4. Convert from Numpy </strong></p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="6f60334e-e982-4eb3-9312-1cefea0c3ede" class="code code-wrap"><code>torch<span class="token punctuation">.</span>from_numpy<span class="token punctuation">(</span>data<span class="token punctuation">)</span> </code></pre></details></li></ul><ul id="62eeb93c-3fa9-4c8b-92c2-7d1b2f80c047" class="toggle"><li><details open=""><summary><strong>Creating tensors from no data </strong></summary><h3 id="671e4079-fc00-43ec-b6b8-24c0e523879e" class="">No data </h3><p id="3870f5c2-551d-4499-bb0c-89c3469b95d4" class="">Five different methods: </p><ol id="1892c0a2-eefa-483e-a35d-7fd3f5ebb266" class="numbered-list" start="1"><li><strong>Blank tensor </strong></li></ol><p id="57eb6f09-41a8-48b6-ad6d-8e40c02ea7de" class="">This can be done with any of the creation methods above (though certain data types may need to be passed as an argument). </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="fd85aad8-30cd-4cfe-ab0a-9b16b9e49535" class="code code-wrap"><code>blank_tensor <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># notice the list since this is a factory function </span></code></pre><p id="ebd9663a-524f-4988-ad31-cfe147208a40" class="">2. <strong>Identity matrix </strong></p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="8664b219-274f-4edc-a6cd-6e4f3a665eb3" class="code code-wrap"><code>t <span class="token operator">=</span> torch<span class="token punctuation">.</span>eye<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment"># 2 is length </span></code></pre><p id="75f6a4b9-3bd5-4fe8-bc44-7984977bc8e2" class=""><strong>3. Zeros </strong></p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="7fcfc91a-66f1-4771-8556-ee523e84d5ac" class="code code-wrap"><code><span class="token comment"># rank-2 tensor (matrix) of all zeroes</span>
torch<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> </code></pre><p id="553927fa-dce9-4712-941c-81959a57806b" class="">4. <strong>Ones </strong></p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="d556b8aa-4894-45f4-bb40-15b5657690b5" class="code code-wrap"><code><span class="token comment"># rank-2 tensor (matrix) of all ones</span>
torch<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> </code></pre><p id="605d5751-4a7d-4dc0-a6a9-2248ac2ec8d0" class="">5. <strong>Randomly</strong> </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="213a8877-060a-4dc4-8c1c-1631367c40d5" class="code code-wrap"><code><span class="token comment"># now randomly</span>
torch<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span></code></pre></details></li></ul><ul id="ef27a75c-5f9c-4f95-bf1a-25bb84ecb43e" class="toggle"><li><details open=""><summary><strong>Tensor attributes </strong></summary><p id="080ea130-d71f-448b-b539-be8c5130997a" class="">The following tensor is used for the examples <code>t = torch.Tensor()</code>.   </p><h3 id="aa52aa41-075f-454d-94eb-e2f086f17a69" class="">Data type </h3><p id="cf3d96cb-8bd4-4c1f-ba95-8e8a55c11fe3" class="">This attribute specifies the type of data of the elements contained within the tensor (i.e. 32-bit floating point) </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="50af100f-8d81-424d-87ea-581c67117379" class="code code-wrap"><code>t<span class="token punctuation">.</span>dtype</code></pre><ul id="3865bb33-af85-47b6-b0d0-6bad0b61ab47" class="toggle"><li><details open=""><summary>Full list of data types </summary><figure id="0fdf098f-ba50-4c3b-bf0d-0352a7613859" class="image"><a href="PyTorch%20Reference%20Document%200fdf098fba504c3bbf0d0352a7613859/Screen_Shot_2020-12-03_at_3.02.38_AM.png"><img style="width:480px" src="PyTorch%20Reference%20Document%200fdf098fba504c3bbf0d0352a7613859/Screen_Shot_2020-12-03_at_3.02.38_AM.png"/></a><figcaption>Notice that there is no strings allowed. </figcaption></figure></details></li></ul><p id="446071db-a40a-47b1-a436-fd0a08bf992b" class=""><strong>Changing data type </strong></p><p id="0e9e4761-eb40-4e44-af79-728a0d2f9a67" class="">In tensor creation, you can actually override the data type and specify the one you want.</p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="b012753f-8785-40b9-a0dc-05b053f79e56" class="code code-wrap"><code>t <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span></code></pre><h3 id="35b838c8-5fce-4d90-8b7f-20a545bbbaa6" class="">Device </h3><p id="3baa711b-8845-465c-8e77-316feabc3d05" class="">Find what hardware the tensor is being stored on (and all of its associated computations). </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="557344c9-1adb-4e09-a921-2680c968ff2c" class="code code-wrap"><code>t<span class="token punctuation">.</span>device</code></pre><p id="291b75c1-2e19-47e5-997d-7b8c4f55448c" class="">Note that you will get an <strong>error</strong> if you try to perform computations between tensors stored on different devices. You will get the following error: <div class="indented"><ul id="f6ec8e51-35d6-4a6c-b573-9dd493d32d11" class="toggle"><li><details open=""><summary>Error statement </summary><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="8589f75a-e2de-4dc9-b3b4-519189fd21f8" class="code code-wrap"><code>>>> Expected all tensors to be on the same device<span class="token punctuation">,</span> but found at least two devices<span class="token punctuation">,</span> cuda:0 and cpu<span class="token operator">!</span></code></pre></details></li></ul></div></p><h3 id="884fe2cd-9be7-4479-b849-870e2f134804" class="">Layout </h3><p id="0ea2c36c-bb53-4279-90b7-6ecda86b120c" class="">This tells us how the data is laid out in memory For more theory, read <a href="https://en.wikipedia.org/wiki/Stride_of_an_array">this</a>. </p><p id="99afe105-2de0-4a7c-b57b-e6fce55f3405" class="">Just know that the standard layout is <strong>strided</strong>. </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="dd139238-9599-4db5-9fa1-7e1904fe0364" class="code code-wrap"><code>t<span class="token punctuation">.</span>layout</code></pre></details></li></ul><ul id="fc11e95b-62c8-41eb-9e08-a4dca9f2ecaf" class="toggle"><li><details open=""><summary><strong>Moving tensors to a GPU </strong></summary><h3 id="71485d3d-884c-407c-a43f-edf64664d48c" class="">See if you are connected to a GPU </h3><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="e5316fe8-b017-4f7a-a93b-0850c9864396" class="code code-wrap"><code>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span> </code></pre><h3 id="0744a630-f33c-4abe-87d3-03791cae908c" class="">Check version of CUDA </h3><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="5fb4aa74-aeeb-48e7-bdb2-a40dbbec8a9f" class="code code-wrap"><code>torch<span class="token punctuation">.</span>version<span class="token punctuation">.</span>cuda</code></pre><h3 id="f7646285-540e-4b0b-b0a5-0c1634f5dc88" class="">Moving a tensor to GPU </h3><p id="973b9fee-15c4-44c4-b53e-d9a9c0d04fd0" class="">By default, tensors are stored on a CPU—even if you have a GPU installed. Thus, you must manually know when to convert something to be on a GPU. </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="499a652a-6efc-4825-add2-cb55afb907c2" class="code code-wrap"><code><span class="token comment"># create a sample tensor</span>
<span class="token keyword">import</span> torch
example_tensor <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>example_tensor<span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p id="4bc73d4b-157a-42ad-9c9a-eb3f5e008e59" class="">Now convert <code>example_tensor</code> to utilize the GPU using CUDA: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="7aba6719-e6b5-4a62-b087-bbd132ce53e7" class="code code-wrap"><code>CUDA_tensor <span class="token operator">=</span> example_tensor<span class="token punctuation">.</span>cuda<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># use this command </span>

<span class="token comment"># output </span>
<span class="token keyword">print</span><span class="token punctuation">(</span>CUDA_tensor<span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> device<span class="token operator">=</span><span class="token string">'cuda:0'</span><span class="token punctuation">)</span>    <span class="token comment"># notice the device named parameter appears </span></code></pre><p id="359e8a59-50a9-4b0e-b456-db24b04f167a" class="">Failure to do this before training, even when a GPU is connected, may result in very long training time. </p><ul id="871d646f-78af-4941-8c06-767da647ba34" class="toggle"><li><details open=""><summary>A note on GPU computation </summary><p id="41095e6a-4bde-41d2-b3d9-dfc25054efef" class="">Moving to the GPU is in it of itself a costly move for efficiency. Thus, it should be done not so often—only when necessary. Also, paradoxically, CPUs-especially for simple calculations-are more efficient in certain scenarios. </p><p id="e27e7383-decd-4921-b2f5-92c9625710dd" class="">Thus, it is recommended that you use GPUs for training with tensors. </p></details></li></ul></details></li></ul><ul id="34d50205-aaa5-4883-ab04-d88cce905c40" class="toggle"><li><details open=""><summary><strong>Rank, axis, and shape  </strong></summary><p id="b34638f2-45b5-4f60-954f-313e9977c878" class="">Three very important concepts about the theoretical representation of a tensor—and they are all associated with one another. </p><ul id="f59e3d97-93bb-4f7a-a152-cfa4a5e69fc3" class="toggle"><li><details open=""><summary><strong>Rank</strong> </summary><p id="7c3dceb3-6f4e-402c-8730-fdcf92adffb7" class="">The rank of a tensor refers to the number of dimensions in that tensor. A <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span></span><span>﻿</span></span>-dimensional tensor is considered a rank-<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span></span><span>﻿</span></span> tensor. </p><p id="f5b93334-161a-405b-86ea-48147aa8e942" class="">The number of dimensions is equivalent to how many indices we need to specify to access an individual element. </p><p id="b9157fb6-ebf0-4fca-a0c5-7562e344c7a3" class="">In code, to identify the rank of a tensor, take the length of its shape (for more information on shape, view below): </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="1fec5a73-9d98-49ca-b839-ff0bcc00d705" class="code code-wrap"><code><span class="token builtin">len</span><span class="token punctuation">(</span>sample_tensor<span class="token punctuation">.</span>shape<span class="token punctuation">)</span></code></pre><p id="83f5a995-570d-4f9f-96c3-564a0d3f95c9" class="">More conveintantly, use PyTorch&#x27;s <code>dim</code> method: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="c5adc3af-ae32-44e6-aac8-80258e583dbe" class="code code-wrap"><code>sample_tensor<span class="token punctuation">.</span>dim<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></details></li></ul><ul id="6b13ce04-7ad2-4e6f-b3a1-fba925f07c26" class="toggle"><li><details open=""><summary><strong>Axis</strong></summary><p id="a08fd98b-896c-455f-8646-d86d52033fe3" class="">In short, <strong>an axis of a tensor is a specific dimension of a tensor</strong>. The length of each axis, tells us how many elements are available along said axis. Note that &#x27;dim&#x27; is another word for axis. </p><p id="9d653ead-05d4-47fb-91ac-15259cd61fdb" class="">For example, in a 2d array, the elements of the first axis would be each row. Then, the elements of the second axis would be all of the elements in each row. </p></details></li></ul><ul id="c4580edb-8ab8-47ab-b352-c69ae9cb1c72" class="toggle"><li><details open=""><summary><strong>Shape</strong></summary><p id="a7a28c56-bb93-49ab-ad44-71dff6cf08b5" class="">Shape is an important concept in machine learning. More often than not, a lot of errors will have to do with shape. </p><p id="9fd8b97d-33e2-48a8-bee8-05ff63a21d2c" class=""><strong>The shape of a tensor shows length of each axis</strong>. It is stored in an object instance of the <code>torch.Size</code> class which is similar to a tuple. Thus, in PyTorch <code>.shape</code> and <code>.size()</code> yield the same thing. </p><p id="f24fec05-c9eb-4fd5-92fd-6813fefa4964" class="">This is useful because once we get to higher dimensions, we won&#x27;t be able to visualize some dimensions, so knowing the length of each axis (dimension) is helpful and gives us concrete information to work with. </p><h3 id="e4d18154-6e67-439e-8236-7fec86068be4" class="">Get the shape of a tensor </h3><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="951190d0-a08d-4b27-86e8-d51740556820" class="code code-wrap"><code>l <span class="token operator">=</span> <span class="token punctuation">[</span>
	<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
	<span class="token punctuation">]</span>

<span class="token comment"># convert to tensor </span>
l_tensor  <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>l<span class="token punctuation">)</span> 

l<span class="token punctuation">.</span>shape</code></pre><p id="0b92bf11-a795-4166-8e0a-ef6f7d790ea1" class="">As you can see, the shape is the length along each axis. </p><p id="63f47707-a17f-4fcd-8f87-b6b5d74bbda3" class="">In other words, the shape contains the how many index values (number of elements) are available along each axis. </p><h3 id="b4ab8be4-faa5-4e46-b5ee-0235a38671b8" class="">Reshaping </h3><p id="9de169e3-c273-44fd-aa36-8f80426c34aa" class="">Reshaping is important for neural networks, and is thus covered more in depth in its own toggle (see tensor operations). Though, it is touched on briefly here. </p><p id="276a93a1-1477-4ee1-8979-5a412941e646" class="">As tensors &quot;flow&quot; throughout our neural networks, different shapes are required at different points in the network. Thus, we will often need to reshape our tensors. </p><p id="0b7f5c79-f597-4966-bfd4-7060c298dc2c" class="">Thus, as programmers, we must understand the incoming shape and reshape as needed. </p><p id="9298a33b-cea7-4d13-a2a8-395aefbee080" class="">However, it should be noted though, that the goal fo reshaping is not to change the meaning of the data held in the tensor, but rather to shift the grouping of it. </p><figure id="8c00c7f3-bee9-4b7d-bea1-e2e18018b542" class="image"><a href="PyTorch%20Reference%20Document%200fdf098fba504c3bbf0d0352a7613859/Screen_Shot_2020-11-28_at_2.20.42_AM.png"><img style="width:192px" src="PyTorch%20Reference%20Document%200fdf098fba504c3bbf0d0352a7613859/Screen_Shot_2020-11-28_at_2.20.42_AM.png"/></a><figcaption>Notice that the terms are grouped differently for each specific shape, but the meaning stays the same </figcaption></figure><h3 id="b330c80f-13a9-40a4-a889-e6d9f79e192b" class="">A note about reshaping </h3><p id="acd16d65-a157-4373-bec1-5bec2667ce84" class="">When reshaping, <strong>the total number of elements must be the same</strong>. In other words, the product of the numbers inside the tuple of the reshape command (i.e. <code>a_tensor.reshape(1,9)</code>) must be the same for the tensor you are reshaping and the resultant tensor shape. </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="bf25eb66-85bd-4aca-b4bc-1b37f887bb0b" class="code code-wrap"><code><span class="token keyword">import</span> torch
arr <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>
og_t <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>og_t<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>og_t<span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token operator">>></span><span class="token operator">></span>      <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token operator">>></span><span class="token operator">></span>      <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

new_t <span class="token operator">=</span> og_t<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>new_t<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>new_t<span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> </code></pre><p id="46cce4d5-01ad-4280-816a-7c8c460bd7e5" class="">Hence, there must be a slot in the data container for each individual element. </p></details></li></ul></details></li></ul><h3 id="f64c18a0-18dd-42e3-a0e6-a3cb321329a8" class="">Tensor Operations </h3><ul id="a4081ce0-199a-4f26-b894-5183d5d5d66a" class="toggle"><li><details open=""><summary><strong>On tensor operations </strong></summary><p id="166333ec-303d-4a1e-bde9-e856c8b952b2" class="">There are TONS of different tensor operations. Thus, it would be useful to categorize them for pedagogical purposes. The following are the categories: </p><ul id="b41fddaf-d695-485e-840b-da88d9359b6c" class="bulleted-list"><li><strong>Reshaping operations </strong></li></ul><ul id="676c5dc3-2db5-4c17-b76f-59e744c72c5b" class="bulleted-list"><li><strong>Element-wise operations</strong></li></ul><ul id="623d5af0-52c3-455e-99be-82e86e83e2da" class="bulleted-list"><li><strong>Reduction</strong> <strong>operations</strong></li></ul><ul id="258390c4-ba6d-49b2-866d-565ff02789bd" class="bulleted-list"><li><strong>Access</strong> <strong>operations </strong></li></ul><p id="7de4cf95-b97a-4e9a-b51e-9485fedb57eb" class="">For more, see the PyTorch docs for the torch package <a href="https://pytorch.org/docs/stable/torch.html">here</a>. </p></details></li></ul><ul id="a868a5f4-7342-4ab2-9b0f-842eff46c9ef" class="toggle"><li><details open=""><summary><strong>Reshaping </strong></summary><p id="b3779676-cf69-40fe-90c2-604ecc26ea05" class="">The theory behind reshaping is touched in the &quot;shape&quot; toggle in the &quot;Tensors&quot; section. </p><p id="7849ca35-a328-45a4-afc9-b4c8c656cc99" class="">In PyTorch, we can reshape a tensor by calling the <code>.reshape()</code> command like so: </p><p id="c4156c00-0666-4ba3-8e50-e0b9854b6e7b" class="">For the length of this toggle, we will use the following tensor to start with: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="0314d720-54c5-45bf-9688-efba1dbaefbe" class="code code-wrap"><code>data <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>
t <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>data<span class="token punctuation">)</span></code></pre><p id="adb72232-2ef7-46fc-b48a-798d4aab5e36" class="">Now for the syntax: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="c1b97138-7e17-43f2-b5a7-3443b8b9bad1" class="code code-wrap"><code><span class="token comment"># you can choose to change the original tensor (changes persist due to mutability)</span>
t<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 

<span class="token comment"># or return it to a new variable </span>
new_t <span class="token operator">=</span> t<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>new_t<span class="token punctuation">)</span> 
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><ul id="5e5ccef5-2e2f-4819-8059-76659ea925a1" class="toggle"><li><details open=""><summary><strong>More 2d reshaping examples</strong></summary><p id="86ec9ca6-fc8c-4ac0-b7e9-e1b2a3b7d213" class="">In this example, the following tensor is used: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="ab230e95-446c-4781-bee0-b2cc77eb8da6" class="code code-wrap"><code>t <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p id="3e150c5b-ca02-4078-bc5d-bc9a8b294c81" class="">This can be reshaped in these ways: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="7bc8eef7-e86c-4afe-b350-05f8b26f7092" class="code code-wrap"><code><span class="token operator">></span> t<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token operator">></span> t<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token operator">></span> t<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token operator">></span> t<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token operator">></span> t<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token operator">></span> t<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre></details></li></ul><p id="57a857fa-a571-46a9-ac15-50d78543722a" class="">Recall that we can reshape a tensor in any way if the components multiply to the number of elements. We are <strong>not restricted to only two dimensions</strong> for certain tensors. </p><ul id="e90d8943-83f3-4a2e-878d-bb19ec6cd498" class="toggle"><li><details open=""><summary><strong>Reshaping in higher than two dimensions </strong></summary><p id="c4b1c20f-c17a-4b60-a249-0f573f98b565" class="">Take the newly defined following tensor: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="d81bf8b2-1bc8-4f78-9345-7907ff660bbb" class="code code-wrap"><code>t <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span> </code></pre><p id="071d14cb-eb4d-4846-aa28-f25b76a1fe7f" class="">We see that the number of elements is equal to <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>12</mn></mrow><annotation encoding="application/x-tex">12</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">2</span></span></span></span></span><span>﻿</span></span>. Thus, we may break this down like so: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="8809a286-274b-4ee2-8942-43587744ff38" class="code code-wrap"><code>t<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment"># 2 * 3 * 2 = 12</span></code></pre><p id="5147d411-7c09-4063-a17b-ebf05fa67168" class="">Instead of running code, let us intuitively understand what the output would be. First, start with the last value in the reshape argument (<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span></span><span>﻿</span></span>) which represents the number of individual elements in the last axis. We know that we need <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>12</mn></mrow><annotation encoding="application/x-tex">12</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">2</span></span></span></span></span><span>﻿</span></span> elements. Thus, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>12</mn><mi mathvariant="normal">/</mi><mn>2</mn><mo>=</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">12/2=6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">/</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">6</span></span></span></span></span><span>﻿</span></span>, which means we need <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn></mrow><annotation encoding="application/x-tex">6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">6</span></span></span></span></span><span>﻿</span></span> sets of <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span></span><span>﻿</span></span>. Which yields us the following: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="4477e36e-a4f2-450f-bff4-c7d362c8f41c" class="code code-wrap"><code><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span> </code></pre><p id="10eb13e6-5926-4340-9a61-43cf172ee31c" class="">We now have <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn></mrow><annotation encoding="application/x-tex">6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">6</span></span></span></span></span><span>﻿</span></span> sets of <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span></span><span>﻿</span></span> (which makes sense since the first two values in the argument multiply to <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn></mrow><annotation encoding="application/x-tex">6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">6</span></span></span></span></span><span>﻿</span></span>). Let us break this down even further. The second value in the reshape argument is a <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span></span><span>﻿</span></span>. This means that we now have to break our <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn></mrow><annotation encoding="application/x-tex">6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">6</span></span></span></span></span><span>﻿</span></span> sets into <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span></span><span>﻿</span></span>. <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn><mi mathvariant="normal">/</mi><mn>3</mn><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">6/3=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">6</span><span class="mord">/</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span></span><span>﻿</span></span>. Thus, we should now have <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span></span><span>﻿</span></span> sets of <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span></span><span>﻿</span></span>. Note that the element is now the set of <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span></span><span>﻿</span></span> (not an individual number). </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="c7a93212-f58c-411e-b026-72d45e3fb5db" class="code code-wrap"><code><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span></code></pre><p id="e9b7021d-83d4-4b6d-abce-5361a20cfc4c" class="">Which yields the our resulting tensor: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="ad1ad1a4-a8a9-4da1-bde3-452fe5de6ff5" class="code code-wrap"><code><span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
         <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
         <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

        <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
         <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
         <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><figure id="9e74a29e-5890-4752-9ce5-6ccbaeeeb922"><div class="source"><a href="PyTorch%20Reference%20Document%200fdf098fba504c3bbf0d0352a7613859/Tensor_reshaping.pdf">https://s3-us-west-2.amazonaws.com/secure.notion-static.com/66b2e5db-2716-4af5-9b44-ec3f9fc09989/Tensor_reshaping.pdf</a></div><figcaption>Here are some handwritten notes on this. </figcaption></figure></details></li></ul></details></li></ul><ul id="b94bdffb-0bfe-4414-ab28-4036f707f3fc" class="toggle"><li><details open=""><summary><strong>Number of components (elements) in a tensor</strong></summary><p id="020c088c-37f7-4f4c-b15b-47bbbaae5b3a" class="">This is highly useful for reshaping since reshaping requires there to be the same number of elements in each tensor. There are two ways to access this.</p><ul id="82c20c99-3412-4698-a9b8-c8406547bdb3" class="bulleted-list"><li><strong>Take the product of constituents of the shape of a tensor: </strong></li></ul><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="ae7143d3-6e24-445a-9dc9-032e8c3a440d" class="code code-wrap"><code>t <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
shape <span class="token operator">=</span> t<span class="token punctuation">.</span>shape
x <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>shape<span class="token punctuation">)</span><span class="token punctuation">.</span>prod<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> <span class="token number">3</span></code></pre><ul id="d7aaa809-11f5-4ea6-a76e-c6541383916b" class="bulleted-list"><li><strong>Use the built in </strong><strong><code>numel()</code></strong><strong> function (</strong><mark class="highlight-red"><strong>recommended</strong></mark><strong>): </strong></li></ul><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="ba16efd0-5eda-4f8e-975e-dfd118407542" class="code code-wrap"><code>t <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
t<span class="token punctuation">.</span>numel<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></details></li></ul><ul id="ac4e0c4c-4461-43e1-901d-19d9e93f475a" class="toggle"><li><details open=""><summary><strong>Squeezing/unsqueezing</strong></summary><h3 id="b21b3a01-4121-49d6-80cb-65fc7f7eb9c7" class="">Squeezing </h3><p id="9c1b7270-ccb4-4ac8-8653-854a4e5841dc" class=""><mark class="highlight-yellow_background"><strong>Squeezing</strong></mark><strong> a tensor removes all of the axes (dimensions) that have a length of one</strong>. </p><p id="81bb3aaa-580e-44de-b69a-292ceac4ddf7" class="">To squeeze a tensor object, use the squeeze method associated with tensor objects that comes built-in with PyTorch. Pass in the original tensor and the method will return a new tensor. </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="f20b9f65-1b80-4594-9a5c-14e7d49054c7" class="code code-wrap"><code>t <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
t<span class="token punctuation">.</span>shape
<span class="token operator">>></span><span class="token operator">></span> torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p id="3091b820-7d60-4165-bcc0-f2ac7689b59e" class="">Now, to squeeze: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="72745895-6b2c-468f-b057-acd4e5f4192d" class="code code-wrap"><code>new_t <span class="token operator">=</span> torch<span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span>t<span class="token punctuation">)</span>
new_t<span class="token punctuation">.</span>shape
<span class="token operator">>></span><span class="token operator">></span> torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> </code></pre><p id="cfc5c510-665a-4da4-85d1-1087a700e7d6" class="">Or: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="c154c898-0416-430d-af0a-9a85014ab7c9" class="code code-wrap"><code>another_t <span class="token operator">=</span> t<span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span><span class="token punctuation">)</span>
another_t<span class="token punctuation">.</span>shape
<span class="token operator">>></span><span class="token operator">></span> torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> </code></pre><h3 id="d81dddb2-71a9-46bc-9f93-a2dd6a935b58" class="">Unsqueezing </h3><p id="13b5c79e-870e-4a87-bead-4e5bdd3e3967" class=""><mark class="highlight-yellow_background"><strong>Unsqueezing</strong></mark><strong> a tensor adds an axis (dimension) with a length of one. </strong></p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="aca5cc2a-07cf-4adb-bb36-44b45b65e679" class="code code-wrap"><code>torch<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span>input_tensor<span class="token punctuation">,</span> dim<span class="token punctuation">)</span> → Tensor</code></pre><p id="e5008248-ddb7-4fe8-86d1-7de601fa3bd9" class=""><strong>dim (int)</strong> – the index at which to insert the singleton dimension</p><p id="c993b614-5b04-4427-8389-9a683d83ca45" class="">Example: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="d8012906-b38c-4b01-9903-144b74f925e5" class="code code-wrap"><code>x <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
new_x <span class="token operator">=</span> torch<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
new_x
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> </code></pre><p id="88786ea2-3467-4b5e-a96a-46c4f773977a" class="">For a deeper understanding, recall that the dimension is equal to the number of indices that need to be specified to get to that dimension. </p><p id="a57280ce-d450-466d-8833-002be03c70d3" class="">For example, the call <code>torch.unsqueeze(t, 1)</code> would result in: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="bf4f1697-f7a4-4ad2-9ae2-311adfcf6d2c" class="code code-wrap"><code>t <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
n <span class="token operator">=</span> torch<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span>t<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
n
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p id="f208e2e3-cf98-4974-b808-65530226b71f" class="">Note that you can also use named parameters for this (i.e. <code>unsqueeze(dim=0)</code>). </p><p id="fe292bda-0149-43c3-b5a4-38ac0ab4752b" class="">
</p><p id="408035f7-e563-44fe-804f-4b3163a3cd09" class="">In essence, these two operations allow us to change the rank of the tensor being operated on. </p></details></li></ul><ul id="4f924649-d015-4186-b459-df5b21809d73" class="toggle"><li><details open=""><summary><strong>Concatenation </strong></summary><p id="95dd4878-044f-486d-963b-324af7ce58f6" class="">We can combine two tensors by using the <code>cat()</code> function: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="ffaccf1a-befc-47ca-9df0-2c01382963b8" class="code code-wrap"><code>t1 <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
t2 <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span> 

n <span class="token operator">=</span> torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span>t1<span class="token punctuation">,</span> t2<span class="token punctuation">)</span>
n 
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p id="6412609a-a41e-4070-a676-773d27d16dd0" class="">We can also specify the dimension: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="e2a9688f-1e12-4d6e-9c0c-1586a44fd434" class="code code-wrap"><code>n torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span><span class="token punctuation">(</span>t1<span class="token punctuation">,</span> t2<span class="token punctuation">)</span><span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
n
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre></details></li></ul><ul id="18fb774c-0edc-42c5-8478-6bd8c38631f7" class="toggle"><li><details open=""><summary><strong>Flatten</strong> </summary><p id="a715de23-bab5-4271-8e10-3bf979c91dd9" class="">More often that not, we will need to perform an operation called &quot;flatten&quot; on our data points when operating on them in a neural networks. More specifically, when passing our data tensors from a convolutional layer to a fully-connected dense layer, we will need to perform a flatten operation. </p><p id="f030c4d9-9615-4dfe-b3eb-39b3ce2f2b05" class="">A <mark class="highlight-yellow_background"><strong>flatten</strong></mark><strong> </strong>operation is taking all of the scalar components of a tensor and squashing them into one giant tensor of one dimension. </p><p id="8049d87b-24fa-4e24-ac2b-ba5d4b928075" class="">Thus, if we had a 2d-tensor (matrix), the flatten operation takes all of the rows and appends them to the first row to create one dimension. </p><p id="793563a8-85c4-43db-ad20-37c0b8a75b1f" class="">Let us look at multiple ways we can achieve this: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="3476f0d0-3164-49c9-a547-f3b1690dd5b7" class="code code-wrap"><code><span class="token comment"># first solution </span>
<span class="token keyword">def</span> <span class="token function">flatten</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">:</span>
	t <span class="token operator">=</span> t<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> t<span class="token punctuation">.</span>numel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	t <span class="token operator">=</span> torch<span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span>t<span class="token punctuation">)</span>
	<span class="token keyword">return</span> t 

<span class="token comment"># second solution </span>
t <span class="token operator">=</span> t<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># third solution </span>
t <span class="token operator">=</span> t<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>t<span class="token punctuation">.</span>numel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># fourth solution </span>
<span class="token keyword">def</span> <span class="token function">flatten</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">:</span>
	t <span class="token operator">=</span> t<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
	t <span class="token operator">=</span> torch<span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span>t<span class="token punctuation">)</span>
	<span class="token keyword">return</span> t

<span class="token comment"># fifth solution </span>
t <span class="token operator">=</span> t<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span> </code></pre><ul id="d1ac642c-18ff-4bef-b6be-aa925c212847" class="toggle"><li><details open=""><summary><strong>Negative dimension specified </strong></summary><p id="f9e59786-fc8d-4221-88d4-8d22a004cfff" class="">If you specify a <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span></span><span>﻿</span></span> in the reshape argument, PyTorch conveniently calculates the correct value for you based on the number of elements in the tensor and the other values specified in the reshape argument. Mathematically: </p><figure id="eab605e5-48bc-43a5-98e2-72729b15c985" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn><mo>+</mo><mi>i</mi><mi>n</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi mathvariant="normal">.</mi><mi>d</mi><mi>i</mi><mi>m</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1 + input.dim() + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">p</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mord">.</span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault">m</span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></span></div></figure></details></li></ul></details></li></ul><ul id="2c45d6ee-af4b-4769-91ad-0641a84fef1d" class="toggle"><li><details open=""><summary><strong>Selective flattening </strong></summary><ul id="f5776b51-2ad8-407b-b18e-245e866f37c0" class="toggle"><li><details open=""><summary><strong>Motivation: theory behind CNN tensors </strong></summary><p id="38b3ced0-ac69-49dd-a5a5-fffd0d04a9a4" class="">In convolutional neural networks, the data must be flattened when passing the tensors from convolutional layers to fully-connected layers. Also, we will be passing in batches of data points into the neural networks, so we will need to know how to flatten individual dimensions of a tensor. </p><p id="90bbb1c3-93b9-4552-af24-c47b67b9aa58" class="">Typically, this is the shape that is being dealt with for tensors that are fed into CNNS: </p><figure id="e5cbba66-4d92-4ebd-b18d-44f9fb3f4886" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>B</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mtext>  </mtext><mi>S</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo separator="true">,</mo><mi>C</mi><mi>h</mi><mi>a</mi><mi>n</mi><mi>n</mi><mi>e</mi><mi>l</mi><mi>s</mi><mo separator="true">,</mo><mi>H</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo separator="true">,</mo><mi>W</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(Batch \; Size, Channels, Height, Width)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mord mathdefault">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">h</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord mathdefault">e</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">h</span><span class="mord mathdefault">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mclose">)</span></span></span></span></span></div></figure><p id="d69f9e30-840a-4574-ae56-67a618ab8f94" class="">For example, take three sample tensors of rank-2 which could be representative of singular images. </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="bc0b1c2c-5456-4061-9aa1-b2d30144867f" class="code code-wrap"><code><span class="token comment"># these are sample three images </span>
t1 <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

t2 <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

t3 <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><h3 id="18cd4827-ced8-4f80-b232-f6eafe6674f0" class="">Creating a batch tensor </h3><p id="de220efb-dae6-4f6d-bb45-094563cb29bd" class="">Let us now convert them into a <strong>batch</strong>. To do this, we can use the <code>stack</code> function: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="d1c33bb5-c31f-4d0b-97d4-d283e5984005" class="code code-wrap"><code>batch <span class="token operator">=</span> torch<span class="token punctuation">.</span>stack<span class="token punctuation">(</span><span class="token punctuation">(</span>t1<span class="token punctuation">,</span>t2<span class="token punctuation">,</span>t3<span class="token punctuation">)</span><span class="token punctuation">)</span>
batch<span class="token punctuation">.</span>shape
<span class="token operator">>></span><span class="token operator">></span> torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><h3 id="f2544b87-9776-4ec6-bde1-1bb350b29d1d" class="">Adding a color channel </h3><p id="aaa52438-ac8d-42b5-a623-3889adae58cd" class="">For CNNs, the tensor needs to include a <strong>color channels </strong>dimension. For grayscale, this would be one, and for RGB, this would be color. As specified above, this color channel axis should be the second axis. Thus, we can simply implement a reshape command </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="2b19a335-0b46-4cfc-8f90-6f3c79ec1c70" class="code code-wrap"><code>new_t <span class="token operator">=</span> batch<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
new_t<span class="token punctuation">.</span>shape
<span class="token operator">>></span><span class="token operator">></span> torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><h3 id="6566840e-7365-4f40-a3de-e46a6d0ca989" class="">Visualizing the tensor </h3><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="6c3cf6a7-5a72-40aa-b3af-9bd1cc8094b8" class="code code-wrap"><code>batch_tensor <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token comment"># batch of 3 images </span>
    <span class="token punctuation">[</span> <span class="token comment"># image one</span>
        <span class="token punctuation">[</span> <span class="token comment"># color channel one</span>
            <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token comment"># color channel two</span>
            <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token comment"># color channel three</span>
            <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span> <span class="token comment"># image two</span>
        <span class="token punctuation">[</span> <span class="token comment"># color channel one</span>
            <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token comment"># color channel two</span>
            <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token comment"># color channel three</span>
            <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span> <span class="token comment"># image three </span>
        <span class="token punctuation">[</span> <span class="token comment"># color channel one</span>
            <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token comment"># color channel two</span>
            <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span> <span class="token comment"># color channel three</span>
            <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre></details></li></ul><h3 id="d74acb77-2074-4c1b-bdad-86e2206e5fb4" class="">Flatten along a specific dimension </h3><p id="7e23aece-2f53-4dd3-8c6f-f58f6c00a816" class="">We need to flatten the image tensors before passing them into a fully-connected layer in a neural network. But we do not want to flatten everything (the whole batch) at once. </p><p id="43c24a17-0b89-4cdc-b485-b457e046043e" class="">Thus, to perform flattening along a single axis, use this: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="270cea06-e5c5-44cc-9c28-5aafb6704f81" class="code code-wrap"><code>flattened_batch <span class="token operator">=</span> batch_tensor<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span>start_dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></code></pre></details></li></ul><ul id="fecc9180-efb8-413b-8b2d-e41b11349d7c" class="toggle"><li><details open=""><summary><strong>Element-wise operations and broadcasting</strong></summary><ul id="617ffe41-8b88-42c2-a1c4-4aebc59e42ff" class="toggle"><li><details open=""><summary><strong>Definition and correspondence </strong> </summary><blockquote id="bb80f025-a3b1-41f5-9fe7-52aab396dda1" class="">&quot;An element-wise operation is an operation between two tensors that operates on corresponding elements within the respective tensors.&quot;<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">^1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> </blockquote><p id="0298599b-9b8d-44fc-b59d-8ba02817f340" class="">An element of one tensor is said to be corresponding to another element in another tensor if, to access said elements, the same indexes are specified. </p><p id="81b0f229-1b04-4a42-bcba-943c15463b52" class="">Take the following two tensors. Each element in <code>t1</code> is of the same color in the corresponding element of that element in <code>t2</code>. </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="370d9321-1ca7-47b8-b42e-0adf5f6b54c0" class="code code-wrap"><code>t1 <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

t2 <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p id="5ad307cb-6326-42e2-bb07-962456e060cd" class="">Thus: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="823403f2-437d-476c-81b2-68fa6d1f8080" class="code code-wrap"><code><span class="token comment"># t1(element) corresponds to --> t2(element) </span>
t1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span> t2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">9</span> 
t1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span> t2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">8</span> 
t1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">3</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span> t2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">7</span> 
t1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">4</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span> t2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">6</span> </code></pre><p id="ef3a818e-8491-413c-aa67-cc318362b305" class="">Also, note that two tensors need to have the <strong>same number of elements </strong>and have to have the <strong>same shape</strong> to perform element-wise operations between them. </p><ul id="fc91c51f-885c-45b2-a73f-fe9ab2b3fad8" class="toggle"><li><details open=""><summary>Why is this needed? </summary><p id="b5a0f167-4749-46a8-9bbc-8e6d460664b2" class="">When a tensor is fed through an neural network, linear algebra comes into play. All of those matrix multiplications are done element-wise. It is neat to see the mathematical theory developed in code. </p></details></li></ul></details></li></ul><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="fc05233d-e0b1-4928-ab43-faa69f591331" class="code code-wrap"><code>t1 <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

t2 <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># element-wise operation </span>
t3 <span class="token operator">=</span> t1 <span class="token operator">+</span> t2
t3
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token operator">>></span><span class="token operator">></span>         <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p id="696d985a-aea3-49cb-982b-78a712503278" class="">Other arithmetic operations are also element-wise operations.  </p><p id="fd787469-86f6-4689-ba7e-6a118ba475a1" class=""><strong>Arithmetic operations using scalar values</strong></p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="a77d3356-716a-41e4-b2e1-67cc2fdd2658" class="code code-wrap"><code>new_t <span class="token operator">=</span> t1 <span class="token operator">*</span> <span class="token number">2</span>
new_t 
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token operator">>></span><span class="token operator">></span>         <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p id="84251b44-be52-4575-8fa5-3c57909551c2" class="">But wait... in the definition above, we specified that the two tensors must be of the same shape and size. Technically, a scalar is a rank-0 tensor... so why does this work. Let us introduce the concept of <strong>broadcasting</strong>. </p><ul id="25222660-ebe5-4117-ab0a-dd58a403c71f" class="toggle"><li><details open=""><summary><strong>Broadcasting </strong></summary><h3 id="1f475536-d042-4442-ad8b-11bf20ffc475" class="">Broadcasting </h3><p id="a7f99ee5-7816-4754-8772-6f029e033c2d" class="">Tensor broadcasting explains how tensors of different shapes are treated during element-wise operations. </p><p id="3ac3e656-089f-48be-a4ca-b45f1cc228c4" class="">For example, in this code, </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="0c19a1c6-f5c1-4e92-9562-dacdacb708b0" class="code code-wrap"><code>new_t <span class="token operator">=</span> t1 <span class="token operator">*</span> <span class="token number">2</span>
new_t 
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token operator">>></span><span class="token operator">></span>         <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p id="4362e32b-693d-428a-a40a-df18135fe687" class="">the <code>2</code> is being &quot;broadcasted&quot; to the shape of <code>t1</code>. </p><p id="a8632a09-326e-473c-a6db-6666d422e64f" class="">In PyTorch, this is done implicitly. However, let us see how this works explicitly.  </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="32e79602-60d4-4a3d-b5b7-5bdfd7a33f1c" class="code code-wrap"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
b <span class="token operator">=</span> np<span class="token punctuation">.</span>broadcast_to<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> t1<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
b
<span class="token operator">>></span><span class="token operator">></span> array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token operator">>></span><span class="token operator">></span>        <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p id="5ee958b3-bd7e-4b38-a873-e11ec3f3e450" class="">Now the element-wise operation is performed. </p><p id="2b75e25c-c733-4708-91f4-3bc48b07dbe5" class="">Broadcasting is often used in preprocessing and normalizing data. </p></details></li></ul><ul id="b33726c5-bf5d-4403-aa4f-42f570aba796" class="toggle"><li><details open=""><summary><strong>Comparison operations </strong></summary><h3 id="ca272cfc-f588-4e0c-a473-de570ddaa197" class="">Comparison operations</h3><blockquote id="36f1a8dd-6f74-410f-a5df-121aeca10448" class=""> In comparison operations, a new tensor of the same shape is returned with each element containing either a boolean value of either <code>True</code> or <code>False</code>. </blockquote><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="2d462869-3361-4ee6-bb27-0f3888b82fff" class="code code-wrap"><code>l1 <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
l2 <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
l3 <span class="token operator">=</span> l1 <span class="token operator">&lt;</span> l2
l3
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p id="22666160-4607-4a51-a1e5-4f95b4a1caac" class="">There are also methods for comparison operators. Here is an example: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="c51bcda5-f6bf-45f9-a89a-c32aff2b5e2a" class="code code-wrap"><code>t <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>

<span class="token comment"># >= </span>
t<span class="token punctuation">.</span>ge<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> 
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token operator">>></span><span class="token operator">></span>         <span class="token punctuation">[</span><span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token operator">>></span><span class="token operator">></span>         <span class="token punctuation">[</span><span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># > </span>
<span class="token operator">></span> t<span class="token punctuation">.</span>gt<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token operator">>></span><span class="token operator">></span>         <span class="token punctuation">[</span><span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token operator">>></span><span class="token operator">></span>         <span class="token punctuation">[</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre></details></li></ul><ul id="769a71d8-4e9d-4558-9435-4982f660b1aa" class="toggle"><li><details open=""><summary><strong>Methods that use element-wise operations  </strong></summary><h3 id="ebb4309b-4c65-4c23-bab7-a759b71f3ead" class="">Methods that use element-wise operations  </h3><p id="7eedb948-31db-4e3e-876c-d541d89eb9ae" class="">Some functions of tensor objects also use broadcasting (implicitly) to perform element-wise operations. Here are some examples: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="53db2e12-a3cb-48a9-890a-7f2ee6dbdd12" class="code code-wrap"><code><span class="token comment"># absolute value </span>
m <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
m<span class="token punctuation">.</span><span class="token builtin">abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token operator">>></span><span class="token operator">></span>         <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># for sqrt, the dtype cannot be int (long) </span>
m <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
m<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3.1623</span><span class="token punctuation">,</span> <span class="token number">4.6904</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token operator">>></span><span class="token operator">></span>         <span class="token punctuation">[</span><span class="token number">1.0000</span><span class="token punctuation">,</span> <span class="token number">1.4142</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre></details></li></ul><p id="0e366611-8f3c-4c78-8c0f-7caa5bcc39bb" class="">Also note that element-wise is sometimes referred to as &quot;component-wise&quot; or &quot;point-wise&quot;. </p></details></li></ul><ul id="f7f39dfa-5191-44f0-aa6f-a1c4419207de" class="toggle"><li><details open=""><summary><strong>Reduction operations (ArgMax)</strong></summary><blockquote id="80d32c6e-079a-4547-bb62-a2630332b8ca" class="">A <mark class="highlight-yellow_background">reduction</mark> operation on a tensor is an operation that reduces the number of elements contained within the tensor.<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">^1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> More specifically, it is an operation within the scalar components of the a tensor. </blockquote><p id="158cc43c-e277-4813-b404-d2491965e99e" class="">Here are some examples: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="c9de11d9-6f82-4e12-b63a-3621793eac80" class="code code-wrap"><code>t <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s <span class="token operator">=</span> t<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
s
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token number">105</span><span class="token punctuation">)</span> 

<span class="token builtin">type</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> torch<span class="token punctuation">.</span>Tensor</code></pre><p id="65662f1b-4e91-4766-887d-8a7552c70e33" class="">As you can see, a reduction operation returns a tensor. </p><p id="b0fa2de8-2199-4f54-abf2-320cdc444875" class="">Here are some more examples: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="bc90e452-a131-46c3-81b5-f8c2edc95aa2" class="code code-wrap"><code>t<span class="token punctuation">.</span>prod<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token number">117210240</span><span class="token punctuation">)</span>

f <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>t<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span> <span class="token comment"># only works with floating point numbers </span>
f<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token number">11.6667</span><span class="token punctuation">)</span></code></pre><ul id="590f33c6-62b1-4348-8af7-12961f7b6f2f" class="toggle"><li><details open=""><summary><strong>Specified dimension</strong></summary><p id="97e5c066-ce42-4a46-a1db-7b3d14641f93" class="">There can also be reductions that don&#x27;t result in rank-0 scalar valued tensors. For example, we can specify the dimension and utilize broadcasting. </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="70209a6c-e428-4106-864d-5b0c91a5af95" class="code code-wrap"><code>t <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>


t<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>dim<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># this is done by broadcasting: t[0] + t[1] + t[2] </span></code></pre><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="6357846b-19a7-4fd0-b8f2-0a8752b93ebf" class="code code-wrap"><code>t<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span> <span class="token number">4</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># this is implicity doing: t[0].sum() + t[1].sum() + t2.sum()</span></code></pre></details></li></ul><ul id="bcfc49c6-f03c-4d59-a090-086d8a930a03" class="toggle"><li><details open=""><summary><strong>ArgMax</strong></summary><p id="f272eb60-4cb9-4e44-8624-d654aad6adfa" class="">ArgMax is a very common operation used a lot specifically in classification outputting. </p><blockquote id="74951bf3-850f-4945-8a4e-6ca2da57bd1f" class="">Argmax returns the index location of the maximum value inside a tensor.<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">^1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span></blockquote><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="f583e672-98b2-400e-8503-9f9295210098" class="code code-wrap"><code>t <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
t<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">)</span>

<span class="token comment"># to get the index, use ArgMax </span>
t<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> </code></pre><p id="7a250347-bef5-43dc-a87b-1643fec53bc9" class="">Implicitly, the tensor is flattened, then the index is found. Thus, the <code>argmax()</code> function is operating on <code>t.flatten()</code> which equals <code>tensor([ 1,  2,  3, 14, 15, 16, 17, 18, 19])</code>. </p><ul id="e87e5760-56f7-4e51-a8f4-a6024653c027" class="toggle"><li><details open=""><summary><strong>ArgMax on a specific dimension</strong></summary><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="c4a9971f-e1c7-420b-b1e0-edbe7ed5bf13" class="code code-wrap"><code>t<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>dim<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> </code></pre><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="960c188b-f032-4c9c-b6c3-4061537a4064" class="code code-wrap"><code>n <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
n<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>dim<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

n<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>dim<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre></details></li></ul></details></li></ul></details></li></ul><ul id="12891e1f-1399-415c-b04b-44292af5e8dc" class="toggle"><li><details open=""><summary><strong>Access operations</strong></summary><p id="4f054172-670a-4194-9657-f1d3a212c4c6" class="">In Python lists, we can access an individual element with <code>list_name[0]</code>. But we cannot do that with tensors and have it return a data type that is usable universally with other python syntax. We can do <code>tensor_name[0]</code> but that still returns a tensor (<code>type(tensor_name[0])</code> &gt;&gt;&gt; <code>torch.Tensor</code>). Thus, we can use the following (and more—check out the PyTorch documentation): </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="8f2d5486-0792-4922-88ec-57589abfccfc" class="code code-wrap"><code>tensor_example <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
tensor_num <span class="token operator">=</span> tensor_example<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> <span class="token number">4</span>

<span class="token builtin">type</span><span class="token punctuation">(</span>tensor_num<span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> <span class="token builtin">int</span> </code></pre><p id="7b420aea-033f-44d2-b344-e9b40f6e109c" class="">Or we can just convert it into a list: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="f5f77ab7-229f-44f0-9f23-c0cf520c22bf" class="code code-wrap"><code>tensor_example<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">)</span> 

<span class="token comment"># another example (with two dimensions) </span>
another_tensor <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
another_tensor<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token operator">>></span><span class="token operator">></span> <span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">)</span>  </code></pre></details></li></ul><h1 id="507f823b-dda8-459d-8145-86541edf538c" class="">Part 2: Neural Networks and Deep Learning </h1><ul id="76f940d6-4d90-4ad7-b20c-0ba5f3382f60" class="toggle"><li><details open=""><summary><strong>A note regarding the next sections </strong></summary><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="a2b4facd-c2ae-4335-8c6b-4b471d1dad26"><div style="font-size:1.5em"><span class="icon">📌</span></div><div style="width:100%">In the next sections, we will be explaining concepts regarding an entire machine learning project. Specifically, the project is to classify fashion item images from the FashionMNIST dataset. </div></figure></details></li></ul><h2 id="5753976b-6e39-45f2-b3da-f69476c949f4" class="">Data and Data Preprocessing</h2><ul id="c78d3051-74a3-47aa-ba8f-754110c5a003" class="toggle"><li><details open=""><summary><strong>Extract, Transform, and Load (ETL)</strong></summary><p id="a74350be-69ff-48d6-b260-3a3bc98d57ed" class="">To prepare data for DL algorithms, we first need to <strong>extract</strong> the data for the data source, <strong>transform</strong> that data into a desirable format, and then we can <strong>load</strong> the data into a suitable format. This pipeline is referred to as <strong>Extract, Transform, and Load (ETL)</strong>. </p><p id="9ac85557-f388-4b4c-bd8c-28dbdd7d159a" class="">Fortunately, PyTorch has a substantial amount built-in packages and classes that ease the ETL process. </p><p id="fb4599be-ccb8-4535-ae3c-8fbe27fcec27" class="">For the project we are following along, the following pipeline for ETL is: </p><ul id="b7b54d3b-3acb-4e0b-b480-6f7946e5cbbd" class="bulleted-list"><li><strong>Extract</strong> - get the Fashion-MNIST image data from the official source. </li></ul><ul id="585fa2db-1a49-4b74-b3f5-808e72b4dfa0" class="bulleted-list"><li><strong>Transform</strong> - put the data into tensor form </li></ul><ul id="8bbbd69f-f353-4a88-a58d-92b325489db8" class="bulleted-list"><li><strong>Load </strong>- put the data into an object for easy accessibility (to be fed into a DL algorithm) </li></ul></details></li></ul><ul id="1b4e8a66-cf67-4bab-abab-9545db413c4d" class="toggle"><li><details open=""><summary><strong><code>Dataset</code></strong></summary><p id="37119bd9-20cb-43ab-96bd-cb5d3184f8cd" class=""><code>Dataset</code> is an <strong>abstract</strong>, extendable <strong>class</strong> in PyTorch for simple <strong>data loading</strong>. When you want to write a custom dataset, you will need to write a new subclass, which inherits the <code>Dataset</code> abstract class. </p><p id="293e9f64-b4b3-4b46-a1be-2192f400b202" class="">When writing the subclass of <code>Dataset</code>, we will be performing the &quot;extract&quot; (retrieve data from source) and &quot;transform&quot; (convert to tensors) phases of the ETL pipeline. </p><ul id="3b413caf-a335-477f-b07e-2ea8e39e82e4" class="toggle"><li><details open=""><summary><strong>Definition from the official documentation </strong></summary><p id="c40d65cb-87ea-44ac-a1bf-d00a9a2def32" class="">&quot;An abstract class representing a <a href="https://pytorch.org/docs/master/data.html#torch.utils.data.Dataset"><code>Dataset</code></a>.</p><p id="5fafd000-86c9-4e23-8b32-3bb1c7319015" class="">All datasets that represent a map from keys to data samples should subclass it. All subclasses should overwrite <code>__getitem__()</code>, supporting fetching a data sample for a given key. Subclasses could also optionally overwrite <code>__len__()</code>, which is expected to return the size of the dataset by many <a href="https://pytorch.org/docs/master/data.html#torch.utils.data.Sampler"><code>Sampler</code></a> implementations and the default options of <a href="https://pytorch.org/docs/master/data.html#torch.utils.data.DataLoader"><code>DataLoader</code></a>.&quot; </p></details></li></ul><ul id="ec2c8c07-13fb-4276-aced-9cdb49c046ce" class="toggle"><li><details open=""><summary><strong>What exactly is a dataset in PyTorch? </strong></summary><p id="94f1db05-362d-4b0c-ab98-5d04a9d4b192" class="">Recall that an abstract class is a class that is not meant to be initialized (i.e. cannot create an object instance it), but rather to have methods that are to be implemented. Thus, we do not actually create objects of PyTorch&#x27;s <code>Dataset</code> class itself, but rather create a subclass that inherits from it. Then, we create an object instance of that class to obtain a dataset. </p><p id="25d5c902-1c00-4c76-a0e9-e61272fbd72f" class="">When we create an instance of our own subclass of <code>Dataset</code>, that is a new type of object. Daniel Godoy put it best: </p><blockquote id="2844da0b-1e9e-47b6-9ad7-f35dfe50f5a6" class="">&quot;You can think of it as a kind of a Python list of tuples, each tuple corresponding to one point (features, label).&quot; - <a href="https://towardsdatascience.com/understanding-pytorch-with-an-example-a-step-by-step-tutorial-81fc5f8c4e8e#2e24">Daniel Godoy</a> </blockquote><p id="3408186b-89cd-4c9e-a431-1bdcc872dbf5" class="">Dissecting this further, the dataset object that we obtain is essentially a Python list which contains tuples where the first element of each tuple is the data point and the second element is the corresponding label. </p><p id="7d4e4ec0-d805-452c-b88a-191fbfd28cae" class=""><strong>Example: </strong></p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="7937a9d8-9407-41d1-91fc-f1c340fe5994" class="code code-wrap"><code><span class="token keyword">print</span><span class="token punctuation">(</span>train_dataset<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> <span class="token punctuation">(</span>tensor<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'nine'</span><span class="token punctuation">)</span>  

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>train_dataset<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">&lt;</span> <span class="token builtin">tuple</span> </code></pre></details></li></ul><ul id="e3466afe-cd00-4624-a1c6-aa846e204cbc" class="toggle"><li><details open=""><summary><strong>Writing the subclass of </strong><strong><code>Dataset</code></strong></summary><p id="b52259a9-24d5-4f5c-b9eb-f6b7333ac8ec" class="">For custom datasets, our job is to write the class in such a way that the object instance of the class is that list of tuples like explained above. To do this: </p><p id="c2c093b9-2833-4b9d-8a20-662a927e0f01" class="">When when subclassing and inheriting from <code>Dataset</code>, we implement two of its methods. </p><ul id="adfe7ebb-9f9a-4338-a966-0917bb30eb1e" class="toggle"><li><details open=""><summary><strong><code>__getitem__</code></strong></summary><p id="92c17be5-d14b-44f9-ae1e-8351bf125e69" class="">This method is <strong>required </strong>to be implemented. </p><p id="d3bac8b9-bd80-4ac5-a743-be1c8651b986" class="">We should write this function such that when an index regarding dataset is given as an argument, it returns the corresponding data point tuple at that index (in conclusion, this returns a single sample from the dataset). </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="5d2d6ecb-55c1-4f60-b7b2-32481ca66a42" class="code code-wrap"><code><span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token triple-quoted-string string">"""insert code here"""</span> 
	<span class="token keyword">pass</span></code></pre></details></li></ul><ul id="059409dc-4c59-4d8c-8554-472609123182" class="toggle"><li><details open=""><summary><strong><code>__len__</code></strong></summary><p id="0e69bb26-f790-47fa-98b8-0f45fd22f318" class="">Gets the length of the dataset. </p><p id="26e055e8-04d2-4a46-8d40-99a721110a6c" class="">This method is <strong>optional </strong>to implement (though, you should do it anyway). </p><p id="e3c3926c-b158-448b-8106-f2a73688abb5" class="">The reason why this is important is that when working with <code>Dataloader</code>, if you want to divide the dataset into batches, then you will need the length for sampling purposes (read about sampling <a href="https://kevinmusgrave.github.io/pytorch-metric-learning/samplers/">here</a>).  </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="083b567a-4e84-4117-bd33-6b5c61b13cca" class="code code-wrap"><code><span class="token keyword">def</span> <span class="token function">__len__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">pass</span>
	<span class="token comment"># return length of dataset </span></code></pre></details></li></ul><p id="e0e75e24-6cdf-4b41-884e-676addcd9de8" class="">Furthermore, since this is a class, we need to implement a constructor. The goal here is to extract the data, transform into tensor form, and split the samples from the labels (<code>self.X</code> and <code>self.y</code> respectively). See the &quot;full example&quot; below which displays this. </p><ul id="33650dd6-db8e-46da-a408-431703f522ed" class="toggle"><li><details open=""><summary><code><strong>TensorDataset</strong></code></summary><p id="e5c6c39d-7f39-492d-937d-26a0542eebb1" class="">Alternatively, if our data is already in tensor format, we can wrap them using <code>TensorDataset</code> to generate our dataset object.    </p></details></li></ul></details></li></ul><ul id="7101e141-0a44-4a10-8271-2c64376fa9e3" class="toggle"><li><details open=""><summary><code><strong>ImageFolder</strong></code></summary><p id="092cb4c9-0ede-40be-a99c-94d2d7d4ba05" class="">Similar to Keras, PyTorch Vision (sits atop Torch) conveniently offers a prebuilt dataset class if the images are arranged like so: <div class="indented"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="ae89d730-b726-46e9-b405-120ae098886b" class="code"><code>root/dog/xxx.png
root/dog/xxy.png
root/dog/xxz.png

root/cat/123.png
root/cat/nsdf3.png
root/cat/asd932_.png</code></pre><ul id="faa5bb74-a081-44d6-a595-d160dae65116" class="bulleted-list"><li>Can specify transformations (i.e. for data augmentation). </li></ul><ul id="af611a54-783d-4232-958e-e9a28e68a811" class="bulleted-list"><li>Required to specify <code>root</code> folder (use <code>&#x27;.&#x27;</code> if you are writing your code in the same folder). </li></ul><p id="c9aaf6eb-e384-49c2-ada9-aaafb53da7d4" class="">An <strong>example</strong>: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="0a181609-5ceb-406e-9d6b-c6c6cea8ecdb" class="code code-wrap"><code>train_set <span class="token operator">=</span> torchvision<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>ImageFolder<span class="token punctuation">(</span><span class="token string">"data/train"</span><span class="token punctuation">,</span> transform <span class="token operator">=</span> transformations_here<span class="token punctuation">)</span>

validation_set <span class="token operator">=</span> torchvision<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>ImageFolder<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token string">"data/validation"</span><span class="token punctuation">,</span> transform <span class="token operator">=</span> transformations_here<span class="token punctuation">)</span></code></pre><p id="8e3adc9e-ea95-4fe7-82f2-77900557003e" class="">See <a href="https://pytorch.org/docs/stable/torchvision/datasets.html#imagefolder">docs</a> for more. </p></div></p></details></li></ul><figure id="3ac0aedb-2009-4ad4-a0b2-e6eaf099bb4b"><div class="source"><a href="PyTorch%20Reference%20Document%200fdf098fba504c3bbf0d0352a7613859/16-Datasets_and_DataLoaders_notebook.ipynb">https://s3-us-west-2.amazonaws.com/secure.notion-static.com/704358ea-4f06-4a07-84cd-f2ba9140ad45/16-Datasets_and_DataLoaders_notebook.ipynb</a></div><figcaption>A notebook showing the concepts executed in Python. </figcaption></figure></details></li></ul><h2 id="a6c93388-cc4d-4679-95f1-c8d29cb7799c" class="">Constructing Neural Networks</h2><ul id="37be1b23-3f4e-4d71-a070-d3bc6506bfb5" class="toggle"><li><details open=""><summary><strong>Background, overview, and motivation </strong></summary><p id="43d5a9b8-6778-4968-a0e5-7de7ec8e32b6" class="">In PyTorch, neural networks are constructed by layers in an object-oriented fashion. That is, each layer in the defined neural network will be an object instance of a layer class. Inside that layer class, two types of abstractions need to be written: <strong>transformation </strong>and <strong>learnable weights </strong>(and biases). Recall that writing classes consists of two things: instance variables and methods. The transformations will be defined as methods whereas the instance variables are used for the learnable weights. </p><p id="944776a1-9c6a-4abf-9d23-d29c88f6279f" class="">Fortunately, PyTorch provides a highly-functional <code>nn</code> module which lets us use their predefined layers—which are objects of their respective classes. Custom layers, if need be, can also be created. </p><p id="ad12d781-202d-4bf6-8819-649706897521" class="">In addition to layers, we also represent entire networks as objects as well (a function of functions essentially). </p><p id="a2ccbe41-6668-4d55-84d1-083d1d0ce7bc" class="">Thus, we should extend PyTorch&#x27;s module base class anytime we create a layer or network. </p><p id="80f84801-4c81-45d2-b96a-3fbf3e02f5db" class="">In building a layer/network, we first construct it, then create a <code>forward</code> method describing the transformation of the tensor inputs through the constructed network/layer. </p></details></li></ul><ul id="f84ec2be-d8f3-4189-8837-6646490c5582" class="toggle"><li><details open=""><summary><strong>The three steps in building neural networks with PyTorch</strong></summary><p id="1f008490-943e-4736-9d21-a9104c0d5369" class="">From <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">^1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>: </p><ol id="9b96e865-684e-4365-9376-6e23df5f4146" class="numbered-list" start="1"><li>Extend the <code>nn.Module</code> base class.</li></ol><ol id="34b7bd5f-1693-40a5-bd60-81e82150edf1" class="numbered-list" start="2"><li>Define layers as class attributes.</li></ol><ol id="61847e60-f829-4f72-89b8-4350323abade" class="numbered-list" start="3"><li>Implement the <code>forward()</code> method. </li></ol></details></li></ul><ul id="a20bbaa6-23ee-451a-b0f2-07581137d695" class="toggle"><li><details open=""><summary><strong>Inheriting </strong><strong><code>nn.Module</code></strong></summary><p id="666767ea-fe3a-411b-8eb6-46e22767d613" class="">When constructing a network or layer, to use PyTorch&#x27;s features, inherit from the <code>nn.Module</code> class (line 1). Furthermore, inherit the super constructor from <code>nn.Module</code> (line 3) as well like so: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="93b5751d-35cf-40b7-8ee4-7bb0a45c407b" class="code code-wrap"><code><span class="token keyword">class</span> <span class="token class-name">Network</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># line 1</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># line 3 </span></code></pre></details></li></ul><ul id="f6cf0ce1-58a5-4fda-aacd-f6ef84d718ab" class="toggle"><li><details open=""><summary>&quot;<strong>Hello, world!&quot; neural network in Pytorch</strong></summary><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="c70f3a34-9c46-46fd-92e1-12e74dcfdbe4" class="code code-wrap"><code><span class="token keyword">class</span> <span class="token class-name">Network</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># line 1</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># line 3</span>
        self<span class="token punctuation">.</span>layer <span class="token operator">=</span> InsertLayerHere

    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">:</span>
        t <span class="token operator">=</span> self<span class="token punctuation">.</span>layer<span class="token punctuation">(</span>t<span class="token punctuation">)</span>
        <span class="token keyword">return</span> t</code></pre></details></li></ul><ul id="63531f66-8066-4e1a-b08c-8104e55df7c3" class="toggle"><li><details open=""><summary><strong>Hyperparameters and data-dependent hyperparameters</strong></summary><p id="7f25852c-42af-4ad1-903e-9f3df5481ebb" class="">These are the two types of parameters we will be using when constructing the layers. A parameter is a place-holder that will eventually hold (data-dependent hyperparameter) or have a value (standard hyperparameter).<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">^1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> </p><p id="c00b72d2-807b-4378-8ca1-6d641986faa6" class="">The difference between the two is that standard hyperparameters do not depend on the data we are trying to process with the layer. That is, no matter what the data is, these can be the same. In contrast, data-dependent hyperparameters are parameters whose values are dependent on data<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">^1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>. That is, the values selected for them will depend on our input data. </p><p id="973f8537-a420-4661-af1d-a232ba7a9a12" class="">We, humans, set the values for these hyperparameters (not to get confused with learnable parameters). Generally, the values are chosen by fine-tuning during experimentation or by previous research that suggests certain values. </p><p id="b22b1e41-e7d2-48f5-86fd-124c9e76a020" class="">The following tables show standard and data-dependent hyperparameters for convolutional and fully-connected layers. </p><p id="4144d023-a208-440c-8ea0-ccd005069bf9" class=""><strong>Standard hyperparameters</strong></p><figure id="a4b366fe-6d17-45ed-aae1-f8d9e6027082" class="image"><a href="PyTorch%20Reference%20Document%200fdf098fba504c3bbf0d0352a7613859/Screen_Shot_2020-12-26_at_2.10.56_AM.png"><img style="width:713px" src="PyTorch%20Reference%20Document%200fdf098fba504c3bbf0d0352a7613859/Screen_Shot_2020-12-26_at_2.10.56_AM.png"/></a></figure><p id="173bc01c-1948-417a-a9e4-8ff920792716" class=""><strong>Data-dependent hyperparameters</strong></p><ul id="cdb50b58-04fd-46ea-9936-d97723981662" class="bulleted-list"><li><code>in_features</code> depends on the input data if it is the first layer. If not, then the parameter value is equal to the output of the previous layer. </li></ul><ul id="597e3cc4-5504-440b-810d-1b6d60672fd3" class="bulleted-list"><li><code>in_channels</code> the same applies as above if this isn&#x27;t the first layer. Except, if this is the first layer, then this represents the number of color channels the image has (RGB = 3 and grayscale = 1).  </li></ul><ul id="1f3b823b-2806-4652-ba91-390f48373fb7" class="bulleted-list"><li>The last layer is always a fully-connected layer in which the <code>out_features</code> depends on the number of classes for classification. For regression, that number depends on the number of values you are trying to predict. </li></ul></details></li></ul><ul id="a058e093-0d89-4dbf-ade7-ab97285d8796" class="toggle"><li><details open=""><summary><strong>Building a fully-connected linear layer</strong></summary><p id="a44e3ceb-c1ad-4d6f-bf45-f80d6d79d532" class="">These are the most simplest layers involved in neural networks. To build one in PyTorch, we need to specify two parameters in the network&#x27;s constructor: <code>in_features</code> and <code>out_features</code>. &quot;When we construct a layer, we pass values for each parameter to the layer’s constructor&quot;<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">^1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>. </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="0e908b9f-a3cd-4911-b80b-55aeaa9c8833" class="code code-wrap"><code>self<span class="token punctuation">.</span>fc1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>in_features<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">,</span> out_features<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span></code></pre><ul id="0a4f6270-c42d-4adb-ad02-3431655bd385" class="toggle"><li><details open=""><summary><strong>If the </strong><code><strong>out_features</strong></code><strong> layer is the last layer: </strong></summary><p id="adcffa35-67e3-4560-be12-3ee4b79539a9" class="">In the network as a whole, &quot;we shrink our <code>out_features</code> as we filter down to our number of output classes.&quot;<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">^1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>. </p></details></li></ul></details></li></ul><ul id="4c2c7137-afc3-4163-9eef-6daea1c02404" class="toggle"><li><details open=""><summary><strong>Learnable parameters</strong></summary><p id="e81fe462-74f3-4b00-a4e7-c6552c303465" class="">&quot;These are the parameters whose values are learned through the learning process&quot;<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">^1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>—this is where the intelligence comes from. These learnable parameters are the <strong>weights</strong> inside our network, and they <strong>live inside each layer</strong><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">^1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>. </p><ul id="cc70ba27-2d39-4bf6-b653-0d02d168aa03" class="toggle"><li><details open=""><summary><strong>Definition from deeplizard</strong></summary><blockquote id="a53b26f3-ea25-424b-b663-61f259ee5676" class="">Learnable parameters are parameters whose values are learned during the training process.</blockquote><blockquote id="dd12e12e-cdc1-47ee-ad6b-9f288fb61a07" class="">With learnable parameters, we typically start out with a set of arbitrary values, and these values then get updated in an iterative fashion as the network learns.</blockquote><blockquote id="2c066a4d-cf7f-4c5f-adbd-44acfe3bf412" class="">In fact, when we say that a network is learning, we specifically mean that the network is learning the appropriate values for the learnable parameters. Appropriate values are values that minimize the loss function.</blockquote></details></li></ul><h3 id="16666001-636a-42a7-80da-4bf29c4de3bd" class="">Accessing learnable parameters</h3><p id="98a4e840-c50e-4c17-843b-10cf83e376af" class="">Since the layers inside the network are objects themselves, we can access their attributes (instance variables) just like any other object in Python by using <strong>dot notation</strong>. <code>torch.nn</code> layer objects store the learnable parameters as attributes. Thus, if we want to access the weight tensor of a particular layer of a particular network, that can be done like so: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="f408f708-1c95-4a13-91cc-2890acd42b74" class="code code-wrap"><code>NeuralNetwork<span class="token punctuation">.</span>conv1<span class="token punctuation">.</span>weight</code></pre><p id="34034f2f-ce4a-4910-b4c1-ee1c21129158" class="">Once data is fed into the network, these weight values inside the weight tensors are optimized—this gives us the intelligence produced by the resultant network. </p></details></li></ul><ul id="2a06978d-54dd-41c5-98c9-4cbdc0f0a624" class="toggle"><li><details open=""><summary><strong>String representation of NNs </strong></summary><p id="7ac35908-31b0-4023-a740-de3bf461aaa4" class="">String representations are what shows up when you try to print out an object, </p><p id="6ca9d273-9af7-4c50-8283-2c39c122b81c" class="">When we build a neural network from <code>torch.nn</code>, we also inherit the <strong>string representation </strong>which formats the network&#x27;s constituents nicely. To see this for yourself, print the object instance out. </p><p id="4b9e9623-89df-47d2-8c37-3978ac7619cb" class="">If desired, we can override this by using <code>__repr__</code>: </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="90399f5d-9bf5-49c5-807c-b813c4b1918f" class="code code-wrap"><code><span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">return</span> <span class="token string">"some object"</span> <span class="token comment"># return string representation here </span></code></pre></details></li></ul><h3 id="1aee063e-d1a8-490f-ba01-e7a87b9cf882" class="">Convolutional Neural Networks </h3><ul id="1070fb2a-09e4-4d3f-9f33-31caadba8448" class="toggle"><li><details open=""><summary><strong>Building a convolutional layer</strong></summary><p id="ac6c38c8-d6ae-479c-8dc4-4be7eb2342be" class="">When building a convolutional layer, we need to specify three parameters: <code>in_channels</code>, <code>out_channels</code>, and <code>kernel_size</code>. </p><ul id="a7e6f3d2-ecbb-47f8-9c83-8a5f85c1c262" class="bulleted-list"><li>For the first layer, <code>in_channels</code><em> </em>is determined by the number of color channels of the input data. Then there after, <code>in_channels</code> is simply the output of the previous layer. </li></ul><ul id="d2a669a4-506f-4720-bd65-3389814a421e" class="bulleted-list"><li><code>out_channels</code> is the number of feature maps outputted after the kernel convolves over the data. </li></ul><ul id="cba1dc69-80d5-4a18-b06b-c2a200407125" class="bulleted-list"><li><code>kernel_size</code> is the size of the window of the convolution operator. Interestingly, the argument is actually a tuple. If you specify one number, then a square kernel will be used. </li></ul><ul id="57dccab2-de2b-4f3b-87db-e4d967df08b0" class="toggle"><li><details open=""><summary><strong>Other parameters (optional)</strong></summary><p id="7b5bd506-7fb7-4db4-9132-cde76f7bfb32" class="">Here is a complete list of parameters for <code>Conv2d</code> layers taken from PyTorch&#x27;s documentation: </p><figure id="63ab58f4-7f7c-444d-a5cb-8b16de695ff8" class="image"><a href="PyTorch%20Reference%20Document%200fdf098fba504c3bbf0d0352a7613859/Screen_Shot_2020-12-28_at_10.52.28_AM.png"><img style="width:923px" src="PyTorch%20Reference%20Document%200fdf098fba504c3bbf0d0352a7613859/Screen_Shot_2020-12-28_at_10.52.28_AM.png"/></a></figure></details></li></ul><p id="11f2e6f3-9969-48db-b2c0-6386c880e3f5" class="">We define our layer inside the constructor, as an instance variable, of our network (just like with fully-connected layers.  </p><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css')</style><pre id="1fcacf71-6ea9-479e-8e88-f303e56dbd1e" class="code code-wrap"><code>self<span class="token punctuation">.</span>conv1 <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>in_channels <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> out_channels <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span> kernel_size <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span></code></pre></details></li></ul><ul id="b72eac44-0204-4f59-8df1-03b7d84e317c" class="toggle"><li><details open=""><summary><strong>A note on the layers of a convolutional neural network </strong></summary><p id="c240d67d-c812-4f91-a137-ef24e234286b" class="">Generally, we aim to increase the <code>out_channels</code> as we add more convolutional layers. Then, after we are done with the convolutional part of the network, we must end with a fully-connected perceptron-type layer. Though, we usually use three-four fully-connected layers to output. </p><p id="7c3a9cb8-2fbe-4093-a7ef-daba16ae92c0" class="">Once we transition from convolutional to fully-connected, several key things occur: </p><ul id="1cf12cee-0543-4195-a770-917ec1df8aef" class="bulleted-list"><li><code>out_features</code> exist as the output instead of <code>out_channels</code>. These represent the nodes of the typical neural network architecture. Generally, in contrast to convolutional layers, we aim to start high for <code>out_features</code> and eventually dwindle our way down to how many classes we have (if regression, modify to number of values you are trying to predict).   </li></ul><ul id="725617ce-bff9-47b4-b035-a3f0e121cb7d" class="bulleted-list"><li>The first <code>in_features</code> parameter value after all of the convolutional layers will need to be delicately determined based on the input data (a <strong>flattening process</strong>). See below for more. </li></ul></details></li></ul><h3 id="b538f011-47e0-49b0-9d3b-7ba9ed7d53dc" class="">References</h3><ul id="79d7780b-a5c6-42a9-bfbd-ced1a10ee333" class="toggle"><li><details open=""><summary><strong>deeplizard</strong><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">^1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span></summary><p id="1e41d4b8-ccc5-4b42-939a-0f35b28ac0cc" class="">This reference guide was created while watching and reading this course from the deeplizard YouTube channel. Often times, the code syntax and definitions for certain concepts just make most sense with how they defined it. Thus, for exact copy-paste situations, I indicated that that was the case through attaching a &#x27;<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">^1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>&#x27; next to it. As mentioned below, this document is still a very rough draft version so there is a good chance that I have missed certain spots where there should be. a citation—as I update this document, I will try to manage this as best as possible. </p><p id="562c1533-a39c-45c8-b55c-9c2e06527841" class="">Also please note that this document is a draft version and the sole intention of this document was to help me better understand the PyTorch deep learning framework. </p></details></li></ul><ul id="800f8a2e-1512-42a6-8ef7-b67c51d5475a" class="toggle"><li><details open=""><summary><strong>Good resources</strong></summary><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="837ab187-58bc-42c3-9a1c-11dd2e185795"><div style="font-size:1.5em"><span class="icon">📌</span></div><div style="width:100%">In the following database, I will list some resources that are good for another point of reference and with more explanation. Some of these sources helped me make this reference document. </div></figure><figure id="d2eb356e-0031-42fa-a7fd-5c45667977bf" class="link-to-page"><a href="PyTorch%20Reference%20Document%200fdf098fba504c3bbf0d0352a7613859/Helpful%20Resources%20d2eb356e003142faa7fd5c45667977bf.html"><span class="icon">📜</span>Helpful Resources </a></figure></details></li></ul></div></article></body></html>
